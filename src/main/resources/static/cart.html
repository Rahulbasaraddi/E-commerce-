<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>My Cart — My E-Comm</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="header">
    <div class="container wrap">
      <div class="brand">Rahulraddi</div>
      <nav class="nav">
        <a class="btn ghost" href="index.html">Back</a>
        <a class="btn cart-btn" href="cart.html" id="cartBtn">Cart <span id="cartCount" class="cart-count">0</span></a>
      </nav>
    </div>
  </header>

  <main class="container">
    <section class="cart-panel">
      <h2 style="margin:0 0 12px">Your Cart</h2>
      <div id="cartArea"></div>
      <div id="cartSummary" style="margin-top:20px"></div>
    </section>
  </main>

  <script src="header.js"></script>
  <script>
    const cartArea = document.getElementById('cartArea');
    const summary = document.getElementById('cartSummary');

    function renderCart(){
      const cart = window.getCart ? getCart() : [];
      cartArea.innerHTML = '';
      if(!cart.length){
        cartArea.innerHTML = '<div style="color:var(--muted);padding:18px">Your cart is empty.</div>';
        summary.innerHTML = '';
        return;
      }

      const container = document.createElement('div');
      container.style.display = 'grid';
      container.style.gap = '12px';

      let total = 0;
      cart.forEach(item=>{
        total += (Number(item.price)||0) * (Number(item.qty)||0);

        const row = document.createElement('div');
        row.style.display = 'flex';
        row.style.gap = '12px';
        row.style.alignItems = 'center';
        row.style.background = 'var(--panel)';
        row.style.padding = '10px';
        row.style.borderRadius = '8px';
        row.style.boxShadow = 'var(--shadow)';

        const thumb = document.createElement('img');
        thumb.src = item.image || '';
        thumb.alt = item.name || '';
        thumb.style.width = '84px';
        thumb.style.height = '64px';
        thumb.style.objectFit = 'cover';
        thumb.style.borderRadius = '6px';

        const txt = document.createElement('div');
        txt.style.flex = '1';
        txt.innerHTML = `<div style="font-weight:700">${item.name}</div>
                         <div style="color:var(--muted);font-size:13px">${item.brand || ''}</div>
                         <div style="margin-top:6px">₹ ${item.price} × ${item.qty} = ₹ ${ (Number(item.price)||0) * (Number(item.qty)||0) }</div>`;

        const controls = document.createElement('div');
        controls.style.display = 'flex';
        controls.style.flexDirection = 'column';
        controls.style.gap = '6px';
        controls.style.alignItems = 'flex-end';

        const qtyRow = document.createElement('div');
        qtyRow.style.display = 'flex';
        qtyRow.style.gap = '6px';
        const minus = document.createElement('button'); minus.type='button'; minus.className='btn ghost small'; minus.textContent='-';
        const plus  = document.createElement('button'); plus.type='button'; plus.className='btn small'; plus.textContent='+';
        const rem   = document.createElement('button'); rem.type='button'; rem.className='btn ghost small'; rem.textContent='Remove';

        minus.addEventListener('click', ()=> { window.changeQty(item.id, -1); renderCart(); });
        plus.addEventListener('click', ()=> { window.changeQty(item.id, +1); renderCart(); });
        rem.addEventListener('click', ()=> { if(confirm('Remove item?')){ window.removeItem(item.id); renderCart(); }});

        qtyRow.appendChild(minus); qtyRow.appendChild(plus); qtyRow.appendChild(rem);
        controls.appendChild(qtyRow);

        row.appendChild(thumb);
        row.appendChild(txt);
        row.appendChild(controls);

        container.appendChild(row);
      });

      cartArea.appendChild(container);

      summary.innerHTML = `<div style="font-weight:800;margin-top:10px">Total: ₹ ${total.toFixed(2)}</div>
                           <div style="margin-top:10px"><button type="button" class="btn">Checkout (demo)</button></div>`;
    }

    document.addEventListener('DOMContentLoaded', renderCart);
  </script>
</body>
</html>
